---
title: "R map creation screencast"
author: "Birasafab"
date: "2023-06-25"
output: html_document
editor_options: 
  chunk_output_type: console
---

# loading all the required packages
```{r}
library(tidyverse)

map_data('world') %>% 
  ggplot(aes(x = long,y= lat,group=group))+
  geom_polygon()+
  ggthemes::theme_map()
```

# Map of the East African community countries
```{r}
map_data('world') %>% 
  filter(region %in% c('Rwanda','Burundi','Kenya','Tanzania','Uganda','South Sudan','Democratic Republic of the Congo')) %>% 
  ggplot(aes(x = long,y= lat,group=group,fill = region))+
  geom_polygon()+
  ggthemes::theme_map()+
  theme(legend.position = 'top')+
  labs(title = "East African community map",
       subtitle = 'this is the map of the east africa containing all the countries currently members of the EAC including DR CONGO')
  
```

# creating continent map
```{r}
library(countrycode)

# creating country codes
continent_data = map_data('world') %>% 
  mutate(count_code = countrycode(region,origin = 'country.name',destination = 'iso3c')) %>% 
  left_join(codelist %>% select(continent, iso3c), by = c('count_code'='iso3c'))%>%
  # removing all the countries/areas without iso3_code
  filter(!is.na(count_code))
```

# reading the UN population prospects as of 2020
```{r}
library(readxl)

read_excel("WPP2022_GEN_F01_DEMOGRAPHIC_INDICATORS_REV1.xlsx", skip = 16)
```


# creating the continent specific map
```{r}
continent_data %>%
  filter(continent == 'Africa' & !is.na(count_code)) %>% 
  ggplot(aes(long,lat,group=group, fill = region))+
  ggthemes::theme_map()+
  geom_polygon()+
  theme(legend.position = 'None')
```



# creating the continent specific map - --- World population prospects
```{r}
final_data %>%
  filter(continent == 'Africa' & !is.na(count_code)) %>% 
  ggplot(aes(long,lat,group=group, fill = total_pop_000))+
  ggthemes::theme_map()+
  geom_polygon()+
  labs(
    title = 'Population size in Africa as of 2020',
    fill = 'Population size'
  )+
  theme(panel.background = element_rect(fill='#add8e6'),
                                        plot.background = element_rect(fill='#eab676'),
        legend.background = element_blank())+
 # guides(fill = guide_legend(labels = comma))+
scale_fill_gradient2(high = 'red',low = 'blue',midpoint = 100000)+
  scale_colour_continuous(formatter = comma) 
  scale_fill_continuous(labels =paste0(c('0','50','100','150','200'),',000,000'))
```
